# 計算フィールド定義

*このドキュメントはTRIR仕様から自動生成されました*

# 計算フィールド定義

## invoice_open_amount

**対象エンティティ**: ar_invoice
**説明**: 請求書の未消込残高（請求額 - 消込済み額）

**計算ロジック**:

self.total_amount - ar_clearingの合計(clear_amount)
  条件: invoice_id = 自身のinvoice_id かつ status = 'ACTIVE'

## receipt_unallocated

**対象エンティティ**: ar_receipt
**説明**: 入金の未消込残高（入金額 - 消込済み額）

**計算ロジック**:

self.amount - ar_clearingの合計(clear_amount)
  条件: receipt_id = 自身のreceipt_id かつ status = 'ACTIVE'

## customer_open_balance

**対象エンティティ**: customer
**説明**: 顧客の売掛金残高（全未消込請求の合計）

**計算ロジック**:

ar_invoiceの合計(open_amount)
  条件: customer_code = 自身のcustomer_code かつ status in '['OPEN', 'PARTIAL']'

## customer_overdue_balance

**対象エンティティ**: customer
**説明**: 顧客の期日超過残高（30日超）

**計算ロジック**:

ar_invoiceの合計(open_amount)
  条件: customer_code = 自身のcustomer_code かつ status in '['OPEN', 'PARTIAL']' かつ ... lt '-30'

## clearing_is_auto_approvable

**対象エンティティ**: ar_clearing
**説明**: 自動承認可能かどうか（確信度90%以上）

**計算ロジック**:

self.match_score >= 90
