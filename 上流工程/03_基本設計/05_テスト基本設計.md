# テスト基本設計

| 項目 | 内容 |
|------|------|
| 文書番号 | DES-TST-ACC-001 |
| 版数 | 1.0 |
| 作成日 | 2026/01/08 |
| 作成者 | システム設計チーム |
| 承認者 | |
| 承認日 | |

---

## 1. テスト戦略

### 1.1 テストレベル定義

| レベル | 目的 | 範囲 | 実施主体 | 環境 |
|--------|------|------|----------|------|
| 単体テスト（UT） | コンポーネント単位の動作確認 | 関数/メソッド/クラス | 開発者 | 開発環境 |
| 結合テスト（IT） | モジュール間・システム間連携確認 | モジュール間IF、外部IF | 開発者/QA | 結合環境 |
| システムテスト（ST） | システム全体の動作確認 | エンドツーエンド | QA | システム環境 |
| 受入テスト（UAT） | 業務要件充足確認 | 業務シナリオ | 経理部門ユーザー | 本番相当環境 |
| 性能テスト | 性能要件の確認 | 応答時間、スループット | QA/インフラ | 性能テスト環境 |
| セキュリティテスト | 脆弱性確認 | 認証・認可・脆弱性 | セキュリティチーム | 専用環境 |
| 移行テスト | データ移行の正確性確認 | 移行データ | QA/開発 | 移行テスト環境 |

### 1.2 テストフェーズと工程

```
[テストフェーズ全体像]

┌─────────────────────────────────────────────────────────────────────────────────┐
│ 開発フェーズ                                                                    │
│  ├─ コーディング                                                               │
│  └─ 単体テスト（UT）                                                           │
│       ├─ 機能単位テスト                                                        │
│       ├─ コードカバレッジ測定                                                   │
│       └─ 静的解析                                                              │
└─────────────────────────────────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│ 結合テストフェーズ（IT）                                                        │
│  ├─ モジュール内結合テスト                                                     │
│  │    ├─ GL内部結合（仕訳→残高→試算表）                                       │
│  │    ├─ AR内部結合（請求→入金→消込）                                         │
│  │    ├─ AP内部結合（請求→支払→消込）                                         │
│  │    └─ 各モジュール内部結合                                                  │
│  ├─ モジュール間結合テスト                                                     │
│  │    ├─ AR→GL連携                                                           │
│  │    ├─ AP→GL連携                                                           │
│  │    ├─ FA→GL連携                                                           │
│  │    ├─ Property→AR→GL連携                                                  │
│  │    └─ Securities→GL連携                                                   │
│  └─ 外部IF結合テスト                                                          │
│       ├─ 銀行連携（EB/FB）                                                    │
│       ├─ 国税庁インボイス検証API                                              │
│       └─ 証券会社連携                                                         │
└─────────────────────────────────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│ システムテストフェーズ（ST）                                                    │
│  ├─ 機能テスト                                                                │
│  │    ├─ 正常系シナリオ                                                       │
│  │    ├─ 異常系シナリオ                                                       │
│  │    └─ 境界値テスト                                                         │
│  ├─ 非機能テスト                                                              │
│  │    ├─ 性能テスト                                                          │
│  │    ├─ セキュリティテスト                                                   │
│  │    └─ 可用性テスト                                                        │
│  ├─ 会計固有テスト                                                            │
│  │    ├─ 試算表一致テスト                                                    │
│  │    ├─ 税集計一致テスト                                                    │
│  │    └─ 監査ログ検証テスト                                                  │
│  └─ 回帰テスト                                                                │
└─────────────────────────────────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│ 受入テストフェーズ（UAT）                                                       │
│  ├─ 業務シナリオテスト                                                        │
│  │    ├─ 日次業務シナリオ                                                    │
│  │    ├─ 月次決算シナリオ                                                    │
│  │    ├─ 四半期決算シナリオ                                                  │
│  │    └─ 年次決算シナリオ                                                    │
│  ├─ 本番リハーサル                                                            │
│  └─ ユーザー承認                                                              │
└─────────────────────────────────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│ 本番移行                                                                        │
│  ├─ 移行リハーサル                                                            │
│  ├─ 本番移行実施                                                              │
│  └─ 本番稼働後検証                                                            │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 1.3 テスト方針

| 方針項目 | 内容 |
|----------|------|
| テスト自動化 | 単体テスト・結合テストは自動化率80%以上を目標 |
| 回帰テスト | リリース前に自動回帰テストを必ず実行 |
| 本番同等環境 | ST/UAT環境は本番同等のデータ量・構成で実施 |
| シフトレフト | 早期段階でのテスト実施、静的解析の活用 |
| リスクベース | 重要度・影響度に応じたテスト密度の設定 |

---

## 2. テスト範囲

### 2.1 機能テスト範囲

#### GL（総勘定元帳）

| 機能 | テスト対象 | 優先度 | テスト密度 | 主なテスト観点 |
|------|------------|--------|------------|----------------|
| 仕訳入力 | 入力、バリデーション、登録 | 高 | 高密度 | 貸借一致、税コード、セグメント |
| 仕訳承認 | 承認/否認、権限チェック | 高 | 高密度 | 承認フロー、金額制限、SoD |
| 仕訳取消 | 赤黒処理、取消仕訳生成 | 高 | 高密度 | 取消後残高、ステータス管理 |
| 仕訳照会 | 検索、表示、出力 | 中 | 中密度 | 電帳法検索要件、権限制御 |
| 試算表 | 残高計算、帳票出力 | 高 | 高密度 | 貸借一致、セグメント集計 |
| 残高推移 | 推移照会、グラフ表示 | 中 | 中密度 | 期間推移、比較機能 |
| 決算締め | 締め処理、再オープン | 高 | 高密度 | 締め後入力不可、繰越処理 |
| 為替処理 | レート取得、換算 | 高 | 高密度 | 期末換算、為替差損益 |

#### AR（売掛金）

| 機能 | テスト対象 | 優先度 | テスト密度 | 主なテスト観点 |
|------|------------|--------|------------|----------------|
| 請求書発行 | インボイス対応、消費税計算 | 高 | 高密度 | インボイス番号、税率別明細 |
| 入金登録 | 入金データ登録、銀行連携 | 高 | 高密度 | EB連携、外貨入金 |
| 入金消込 | 消込ロジック、差額処理 | 高 | 高密度 | 自動消込、部分消込、過入金 |
| 債権照会 | エイジング、滞留分析 | 中 | 中密度 | エイジング区分、滞留アラート |
| 得意先残高 | 残高照会、入金予定 | 中 | 中密度 | 残高整合性、予定照会 |

#### AP（買掛金）

| 機能 | テスト対象 | 優先度 | テスト密度 | 主なテスト観点 |
|------|------------|--------|------------|----------------|
| 請求書登録 | インボイス検証、税額計算 | 高 | 高密度 | 登録番号検証、経過措置 |
| 支払処理 | FBデータ作成、承認 | 高 | 高密度 | 全銀フォーマット、承認フロー |
| 支払消込 | 消込処理、差額処理 | 高 | 高密度 | 部分支払、源泉徴収 |
| 債務照会 | エイジング、支払予定 | 中 | 中密度 | 支払スケジュール、キャッシュフロー |
| インボイス検証 | 国税庁API連携 | 高 | 高密度 | API連携、検証結果保存 |

#### FA（固定資産）

| 機能 | テスト対象 | 優先度 | テスト密度 | 主なテスト観点 |
|------|------------|--------|------------|----------------|
| 資産登録 | 資産情報登録、取得仕訳 | 高 | 高密度 | 耐用年数、償却方法 |
| 減価償却 | 月次償却計算、仕訳生成 | 高 | 高密度 | 定額法/定率法、端数処理 |
| 除却・売却 | 除却処理、売却損益 | 高 | 高密度 | 帳簿価額、損益計算 |
| 資産照会 | 台帳照会、償却シミュレーション | 中 | 中密度 | 台帳出力、将来償却予測 |
| 減損処理 | 減損テスト、減損仕訳 | 中 | 中密度 | 減損判定、会計処理 |

#### Property（不動産）

| 機能 | テスト対象 | 優先度 | テスト密度 | 主なテスト観点 |
|------|------------|--------|------------|----------------|
| 物件登録 | 物件情報、FA連携 | 高 | 高密度 | マスタ整合性、FA連携 |
| 契約登録 | 賃貸借契約、賃料スケジュール | 高 | 高密度 | 契約条件、フリーレント |
| 賃料計上 | 月次賃料収入、仕訳生成 | 高 | 高密度 | 前受/当月、IFRS按分 |
| 敷金管理 | 受入/返還、利息計上 | 高 | 高密度 | 敷金残高、利息計算 |
| 収支照会 | 物件別収支、NOI計算 | 中 | 中密度 | 収支集計、稼働率 |

#### Securities（有価証券）

| 機能 | テスト対象 | 優先度 | テスト密度 | 主なテスト観点 |
|------|------------|--------|------------|----------------|
| 売買取引 | 購入/売却、仕訳生成 | 高 | 高密度 | 取得原価、売却損益 |
| 時価評価 | 月次評価、評価仕訳 | 高 | 高密度 | 区分別評価、OCI処理 |
| 配当管理 | 配当受領、源泉徴収 | 高 | 高密度 | 配当仕訳、源泉税 |
| 保有照会 | 保有明細、評価レポート | 中 | 中密度 | 保有一覧、パフォーマンス |
| 外貨評価 | 外貨建証券、為替換算 | 高 | 高密度 | 外貨評価、換算差額 |

#### Tax（税務）

| 機能 | テスト対象 | 優先度 | テスト密度 | 主なテスト観点 |
|------|------------|--------|------------|----------------|
| 消費税計算 | 税区分別集計、申告補助 | 高 | 高密度 | 課税売上、課税仕入 |
| 仕入税額控除 | 控除計算、経過措置 | 高 | 高密度 | 控除率、按分計算 |
| 申告データ | 申告書作成補助 | 高 | 高密度 | 様式対応、集計正確性 |

### 2.2 非機能テスト範囲

| テスト種別 | テスト対象 | 基準値 | 測定方法 |
|------------|------------|--------|----------|
| 性能（応答） | 仕訳登録 | 3秒以内 | レスポンスタイム計測 |
| 性能（応答） | 仕訳照会（100件） | 2秒以内 | レスポンスタイム計測 |
| 性能（応答） | 試算表表示 | 5秒以内 | レスポンスタイム計測 |
| 性能（バッチ） | 月次償却計算（1,000件） | 10分以内 | バッチ実行時間 |
| 性能（バッチ） | 月次時価評価（500件） | 5分以内 | バッチ実行時間 |
| 性能（バッチ） | 月次締め処理 | 30分以内 | バッチ実行時間 |
| 性能（大量） | 仕訳10,000件検索 | 10秒以内 | レスポンスタイム計測 |
| 性能（同時） | 同時ユーザー50人 | 応答劣化なし | 負荷テスト |
| 可用性 | システム稼働率 | 99.5%以上 | 監視ツール |
| 可用性 | フェイルオーバー | 5分以内 | 障害シミュレーション |
| セキュリティ | 認証・認可 | 脆弱性なし | ペネトレーションテスト |
| セキュリティ | SQLインジェクション | 脆弱性なし | 脆弱性診断 |
| セキュリティ | XSS | 脆弱性なし | 脆弱性診断 |
| 監査 | ログ記録 | 漏れなし | ログ出力確認 |
| 監査 | ログ改ざん検知 | 検知可能 | ハッシュ検証 |

---

## 3. テストデータ方針

### 3.1 テストデータ設計

| データ区分 | 内容 | 件数 | 作成方法 |
|------------|------|------|----------|
| マスタデータ | 勘定科目、税コード、通貨等 | 本番同等 | 本番コピー |
| マスタデータ | 得意先、仕入先 | 本番同等（匿名化） | 本番コピー+匿名化 |
| マスタデータ | 物件、銘柄 | 本番同等（匿名化） | 本番コピー+匿名化 |
| トランザクション（少量） | 機能テスト用 | 各パターン10件 | 手作成 |
| トランザクション（中量） | 結合テスト用 | 1,000件 | ツール生成 |
| トランザクション（大量） | 性能テスト用 | 100万件 | ツール生成 |
| 境界値データ | 端数、最大桁等 | 各ケース | 手作成 |
| 異常データ | 不正入力パターン | 各ケース | 手作成 |

### 3.2 テストデータパターン

#### 仕訳データパターン

| パターンID | パターン名 | 説明 | 用途 |
|------------|------------|------|------|
| JE-001 | 通常仕訳（単一税率10%） | 標準10%の売上仕訳 | 正常系基本 |
| JE-002 | 通常仕訳（軽減税率8%） | 軽減8%の売上仕訳 | 軽減税率テスト |
| JE-003 | 混合仕訳（10%+8%） | 複数税率混在 | 税計算テスト |
| JE-004 | 外貨仕訳（USD） | USD建て取引 | 為替テスト |
| JE-005 | 外貨仕訳（EUR） | EUR建て取引 | 為替テスト |
| JE-006 | 端数仕訳 | 端数処理が発生する金額 | 端数処理テスト |
| JE-007 | 大量明細（100行） | 100明細の仕訳 | 性能テスト |
| JE-008 | 最小金額（1円） | 金額1円 | 境界値テスト |
| JE-009 | 最大金額 | 999,999,999,999円 | 境界値テスト |
| JE-010 | セグメント全指定 | PC/CC/PRJ/物件/PF全指定 | セグメントテスト |
| JE-011 | 決算仕訳 | 決算整理仕訳 | 決算テスト |
| JE-012 | 取消仕訳 | 既存仕訳の取消 | 取消テスト |

#### 消費税データパターン

| パターンID | パターン名 | 説明 | 用途 |
|------------|------------|------|------|
| TAX-001 | 適格請求書あり（10%） | インボイス登録事業者からの仕入 | 正常系 |
| TAX-002 | 適格請求書あり（8%） | 軽減税率のインボイス仕入 | 軽減税率テスト |
| TAX-003 | 適格請求書なし（経過措置80%） | 2023/10-2026/9の免税事業者仕入 | 経過措置テスト |
| TAX-004 | 適格請求書なし（経過措置50%） | 2026/10-2029/9の免税事業者仕入 | 経過措置テスト |
| TAX-005 | 適格請求書なし（控除不可） | 2029/10以降の免税事業者仕入 | 控除不可テスト |
| TAX-006 | 非課税取引 | 非課税売上/仕入 | 非課税テスト |
| TAX-007 | 免税取引 | 輸出免税 | 免税テスト |
| TAX-008 | 不課税取引 | 対象外取引 | 不課税テスト |
| TAX-009 | 課税売上割合95%未満 | 個別対応/一括比例配分 | 控除計算テスト |

#### 為替データパターン

| パターンID | パターン名 | 説明 | 用途 |
|------------|------------|------|------|
| FX-001 | 為替差益（実現） | 入金時に円安 | 換算テスト |
| FX-002 | 為替差損（実現） | 入金時に円高 | 換算テスト |
| FX-003 | 為替差益（評価） | 期末評価で円安 | 期末換算テスト |
| FX-004 | 為替差損（評価） | 期末評価で円高 | 期末換算テスト |
| FX-005 | レート取得失敗 | 外部API障害 | 異常系テスト |
| FX-006 | 異常レート | 前日比±20%超 | 警告テスト |

#### 不動産データパターン

| パターンID | パターン名 | 説明 | 用途 |
|------------|------------|------|------|
| PR-001 | 通常賃貸（当月払い） | 標準的な賃貸契約 | 正常系 |
| PR-002 | 前受賃料 | 翌月分前払い | 前受処理テスト |
| PR-003 | フリーレント | 3ヶ月フリーレント | IFRS按分テスト |
| PR-004 | 敷金受入 | 敷金6ヶ月分 | 敷金テスト |
| PR-005 | 敷金返還 | 退去時返還 | 敷金返還テスト |
| PR-006 | 賃料改定 | 更新時賃料増額 | 改定テスト |
| PR-007 | 中途解約 | 契約期間中解約 | 解約テスト |

#### 有価証券データパターン

| パターンID | パターン名 | 説明 | 用途 |
|------------|------------|------|------|
| SC-001 | 売買目的株式（購入） | 時価評価→P/L | 購入テスト |
| SC-002 | 売買目的株式（売却） | 売却損益計算 | 売却テスト |
| SC-003 | その他有価証券（購入） | 時価評価→OCI | 購入テスト |
| SC-004 | その他有価証券（売却） | リサイクリング | 売却テスト |
| SC-005 | 満期保有債券 | 償却原価法 | 債券テスト |
| SC-006 | 関係会社株式 | 原価法、減損 | 関係会社テスト |
| SC-007 | 外貨建証券 | 外貨評価+為替換算 | 外貨テスト |
| SC-008 | 配当金受領 | 源泉徴収あり | 配当テスト |
| SC-009 | 評価損（減損） | 著しい下落 | 減損テスト |

### 3.3 多会社テストデータ

| 会社コード | 会社名 | 基準通貨 | 会計基準 | 用途 |
|------------|--------|----------|----------|------|
| 1000 | 本社 | JPY | J-GAAP | 親会社テスト |
| 1100 | IT事業子会社 | JPY | J-GAAP | 国内子会社テスト |
| 1200 | 不動産子会社 | JPY | J-GAAP | 不動産テスト |
| 1300 | 投資運用子会社 | JPY | J-GAAP | 有価証券テスト |
| 2000 | 海外子会社（米国） | USD | US-GAAP | 海外子会社テスト |
| 2100 | 海外子会社（欧州） | EUR | IFRS | IFRS子会社テスト |

---

## 4. 出口基準

### 4.1 単体テスト出口基準

| 基準項目 | 基準値 | 測定方法 | 必須/推奨 |
|----------|--------|----------|----------|
| テストケース消化率 | 100% | 実施数/計画数 | 必須 |
| テスト成功率 | 100% | 成功数/実施数 | 必須 |
| コードカバレッジ（C0） | 80%以上 | JaCoCo等 | 必須 |
| コードカバレッジ（C1） | 70%以上 | JaCoCo等 | 推奨 |
| 静的解析（重大） | 0件 | SonarQube等 | 必須 |
| 静的解析（中程度） | 10件以下 | SonarQube等 | 推奨 |
| Criticalバグ残存数 | 0件 | バグ管理ツール | 必須 |
| Highバグ残存数 | 0件 | バグ管理ツール | 必須 |

### 4.2 結合テスト出口基準

| 基準項目 | 基準値 | 測定方法 | 必須/推奨 |
|----------|--------|----------|----------|
| テストケース消化率 | 100% | 実施数/計画数 | 必須 |
| テスト成功率 | 98%以上 | 成功数/実施数 | 必須 |
| モジュール間IF連携成功率 | 100% | 連携成功数/連携数 | 必須 |
| 外部IF連携成功率 | 100% | 連携成功数/連携数 | 必須 |
| Criticalバグ残存数 | 0件 | バグ管理ツール | 必須 |
| Highバグ残存数 | 0件 | バグ管理ツール | 必須 |
| Mediumバグ残存数 | 5件以下 | バグ管理ツール | 推奨 |

### 4.3 システムテスト出口基準

| 基準項目 | 基準値 | 測定方法 | 必須/推奨 |
|----------|--------|----------|----------|
| テストケース消化率 | 100% | 実施数/計画数 | 必須 |
| テスト成功率 | 98%以上 | 成功数/実施数 | 必須 |
| 試算表一致率 | 100% | 手計算との照合 | 必須 |
| 税集計一致率 | 100% | 手計算との照合 | 必須 |
| GL/サブレジャ残高一致率 | 100% | SQL照合 | 必須 |
| 監査ログ出力率 | 100% | ログ件数確認 | 必須 |
| 性能基準達成率 | 全項目達成 | 性能テスト結果 | 必須 |
| セキュリティ脆弱性 | Critical/High: 0件 | 脆弱性診断 | 必須 |
| Criticalバグ残存数 | 0件 | バグ管理ツール | 必須 |
| Highバグ残存数 | 0件 | バグ管理ツール | 必須 |

### 4.4 受入テスト出口基準

| 基準項目 | 基準値 | 測定方法 | 必須/推奨 |
|----------|--------|----------|----------|
| 業務シナリオ完了率 | 100% | 完了数/計画数 | 必須 |
| 日次業務シナリオ承認 | 承認 | ユーザー承認書 | 必須 |
| 月次決算シナリオ承認 | 承認 | ユーザー承認書 | 必須 |
| 四半期/年次決算シナリオ承認 | 承認 | ユーザー承認書 | 必須 |
| 本番リハーサル完了 | 完了 | リハーサル報告書 | 必須 |
| 移行リハーサル完了 | 完了 | 移行報告書 | 必須 |
| ユーザー最終承認 | 全承認者承認 | 承認書 | 必須 |
| Criticalバグ残存数 | 0件 | バグ管理ツール | 必須 |
| Highバグ残存数 | 0件 | バグ管理ツール | 必須 |

---

## 5. 会計システム固有のテスト観点

### 5.1 試算表一致テスト

| テスト項目 | 検証内容 | 検証方法 | 頻度 |
|------------|----------|----------|------|
| 貸借バランス | B/S資産合計 = B/S負債合計 + 純資産合計 | 試算表出力確認 | 毎テスト |
| 損益バランス | P/L収益合計 = P/L費用合計 + 当期純利益 | 試算表出力確認 | 毎テスト |
| 仕訳-残高整合 | 仕訳明細借方合計 = 勘定残高借方発生額合計 | SQL照合スクリプト | 日次 |
| 期首残高繰越 | 前期末残高 = 当期首残高 | SQL照合スクリプト | 期初 |
| セグメント集計 | セグメント別合計 = 全社合計 | SQL照合スクリプト | 月次 |

```sql
-- 試算表一致検証SQL例
SELECT
    fiscal_period,
    SUM(CASE WHEN dr_cr = 'DR' THEN amount_base ELSE 0 END) as total_debit,
    SUM(CASE WHEN dr_cr = 'CR' THEN amount_base ELSE 0 END) as total_credit,
    SUM(CASE WHEN dr_cr = 'DR' THEN amount_base ELSE 0 END) -
    SUM(CASE WHEN dr_cr = 'CR' THEN amount_base ELSE 0 END) as diff
FROM t_journal_line jl
JOIN t_journal_header jh ON jl.journal_id = jh.journal_id
WHERE jh.status = '30'  -- 承認済のみ
GROUP BY fiscal_period
HAVING SUM(CASE WHEN dr_cr = 'DR' THEN amount_base ELSE 0 END) <>
       SUM(CASE WHEN dr_cr = 'CR' THEN amount_base ELSE 0 END);
-- 結果が0件であること
```

### 5.2 税集計一致テスト

| テスト項目 | 検証内容 | 検証方法 | 頻度 |
|------------|----------|----------|------|
| 課税売上集計 | 仕訳の課税売上合計 = 消費税申告データ | 帳票照合 | 四半期 |
| 課税仕入集計 | 仕訳の課税仕入合計 = 消費税申告データ | 帳票照合 | 四半期 |
| 控除税額計算 | 仕入税額控除額の正確性 | 手計算照合 | 四半期 |
| 経過措置控除 | 控除率(80%/50%/0%)の正確性 | 手計算照合 | 四半期 |
| インボイス集計 | 適格/非適格の区分正確性 | 帳票照合 | 四半期 |

### 5.3 サブレジャGL照合テスト

| テスト項目 | 検証内容 | 検証方法 | 頻度 |
|------------|----------|----------|------|
| AR/GL照合 | AR売掛金残高 = GL売掛金勘定残高 | SQL照合 | 月次 |
| AP/GL照合 | AP買掛金残高 = GL買掛金勘定残高 | SQL照合 | 月次 |
| FA/GL照合 | FA帳簿価額合計 = GL固定資産勘定残高 | SQL照合 | 月次 |
| SEC/GL照合 | SEC評価額合計 = GL投資有価証券残高 | SQL照合 | 月次 |
| PR/GL照合 | PR敷金残高 = GL敷金勘定残高 | SQL照合 | 月次 |

### 5.4 監査ログ検証テスト

| テスト項目 | 検証内容 | 検証方法 | 頻度 |
|------------|----------|----------|------|
| ログ出力漏れ | 全操作がログ出力されること | ログ件数確認 | 毎テスト |
| ログ内容正確性 | 必須項目が全て正確に記録 | ログ内容確認 | 毎テスト |
| 改ざん検知 | ハッシュチェーンの整合性 | ハッシュ再計算 | 日次 |
| タイムスタンプ | TSA署名の有効性 | 署名検証 | 月次 |
| ログ検索 | 監査で必要な検索が可能 | 検索実行 | 毎テスト |
| ログ保管 | 保管期間（10年）の確認 | 設定確認 | 初回 |

### 5.5 月次決算シナリオテスト

```
[月次決算テストシナリオ]

フェーズ1: 日次処理（1-25日）
├─ 1. 売上計上
│    ├─ プロジェクト売上（T&M/固定/POC）
│    ├─ 賃料収入計上
│    └─ 配当金受領
├─ 2. 仕入計上
│    ├─ 外注費計上
│    ├─ 経費計上
│    └─ インボイス検証
├─ 3. 入金処理
│    ├─ EB取込
│    └─ 入金消込
├─ 4. 支払処理
│    ├─ 支払データ作成
│    ├─ FB出力
│    └─ 支払消込
└─ 検証ポイント
     ├─ 仕訳の貸借一致
     └─ 承認フローの正常動作

フェーズ2: 月次処理（26-末日）
├─ 5. 減価償却
│    ├─ 償却計算実行
│    └─ 償却仕訳確認
├─ 6. 有価証券評価
│    ├─ 時価取得
│    ├─ 評価計算実行
│    └─ 評価仕訳確認
├─ 7. 為替換算
│    ├─ 外貨残高抽出
│    ├─ 期末レート取得
│    └─ 換算仕訳確認
├─ 8. 経過勘定
│    ├─ 前払費用振替
│    └─ 未払費用計上
└─ 検証ポイント
     ├─ バッチ処理完了
     └─ 自動仕訳の正確性

フェーズ3: 月次締め
├─ 9. サブレジャ締め
│    ├─ AR締め実行
│    ├─ AP締め実行
│    └─ FA締め実行
├─ 10. GL締め
│    └─ GL締め実行
├─ 11. 締め後検証
│    ├─ 試算表出力・確認
│    ├─ サブレジャ照合
│    ├─ 消費税集計確認
│    └─ 監査ログ確認
└─ 検証ポイント
     ├─ 試算表の貸借一致
     ├─ GL/サブレジャ残高一致
     └─ 締め後の入力不可確認

フェーズ4: 翌月繰越
├─ 12. 繰越処理
│    └─ 期首残高設定
└─ 検証ポイント
     └─ 期首残高＝前期末残高
```

### 5.6 年次決算シナリオテスト

```
[年次決算テストシナリオ]

1. 決算整理前残高確認
   ├─ 12月末試算表出力
   └─ サブレジャ残高照合

2. 決算整理仕訳
   ├─ 減損処理
   ├─ 貸倒引当金計上
   ├─ 賞与引当金計上
   ├─ 退職給付引当金計上
   ├─ 税効果会計処理
   └─ その他決算整理

3. 消費税確定申告
   ├─ 年間集計
   ├─ 申告データ作成
   └─ 精算仕訳

4. 決算確定
   ├─ 試算表最終確認
   ├─ 財務諸表出力
   └─ 監査法人提出資料

5. 期末締め
   ├─ 年度締め実行
   └─ 締め後検証

6. 翌期首処理
   ├─ 繰越残高設定
   ├─ P/L科目繰越（利益剰余金）
   └─ 翌期首残高確認
```

---

## 6. テスト環境

### 6.1 環境構成

| 環境名 | 用途 | データ量 | 本番同等性 | 利用者 |
|--------|------|----------|------------|--------|
| 開発環境（DEV） | 開発、単体テスト | 少量（1,000件） | 低 | 開発者 |
| 結合環境（IT） | 結合テスト | 中量（10,000件） | 中 | 開発者、QA |
| システム環境（ST） | システムテスト | 本番同等（100万件） | 高 | QA |
| 受入環境（UAT） | 受入テスト | 本番同等（100万件） | 高 | QA、ユーザー |
| 性能環境（PERF） | 性能テスト | 大量（500万件） | 高 | QA、インフラ |
| 移行環境（MIG） | 移行テスト | 本番データ | 高 | 移行チーム |

### 6.2 環境構成詳細

| 項目 | DEV | IT | ST/UAT | PERF |
|------|-----|-----|--------|------|
| APサーバー | 1台 | 2台 | 3台 | 3台 |
| DBサーバー | 1台 | 1台（レプリカなし） | 2台（Primary+Standby） | 2台 |
| CPU（AP） | 2vCPU | 4vCPU | 4vCPU | 4vCPU |
| メモリ（AP） | 8GB | 16GB | 16GB | 16GB |
| CPU（DB） | 2vCPU | 4vCPU | 8vCPU | 8vCPU |
| メモリ（DB） | 16GB | 32GB | 64GB | 64GB |
| ストレージ | 100GB | 200GB | 1TB | 2TB |

### 6.3 環境利用ルール

| 項目 | ルール |
|------|--------|
| 環境予約 | 事前予約制（Confluenceカレンダー） |
| データ初期化 | テスト開始前にスクリプトで初期化 |
| 本番データ利用 | 匿名化スクリプト適用必須 |
| アクセス制限 | VPN経由、担当者のみアクセス可 |
| 障害時対応 | インフラチームへチケット起票 |
| ログ保管 | テスト実行ログは1ヶ月保管 |

---

## 7. バグ管理

### 7.1 バグ重要度定義

| 重要度 | 定義 | 例 | 対応期限 |
|--------|------|-----|----------|
| Critical | システム停止、データ破壊、セキュリティ重大脆弱性 | 仕訳データ消失、認証バイパス | 即時対応 |
| High | 主要機能使用不可、重大な計算誤り | 試算表不一致、消費税計算誤り | 24時間以内 |
| Medium | 機能制限あり、回避策あり | 特定条件で画面エラー、帳票レイアウト崩れ | 1週間以内 |
| Low | 軽微な不具合、改善要望 | 表示文言誤り、UI改善要望 | 次リリース |

### 7.2 バグ管理フロー

```
[バグ管理フロー]

┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│バグ発見  │───→│  起票    │───→│トリアージ│───→│担当割当  │
└──────────┘    └──────────┘    └──────────┘    └──────────┘
                                                      │
                 ┌────────────────────────────────────┘
                 ▼
           ┌──────────┐    ┌──────────┐    ┌──────────┐
           │修正開発  │───→│修正確認  │───→│リリース  │
           └──────────┘    └──────────┘    └──────────┘
                                                 │
                 ┌───────────────────────────────┘
                 ▼
           ┌──────────┐    ┌──────────┐
           │再テスト  │───→│クローズ  │
           └──────────┘    └──────────┘
```

### 7.3 バグ報告項目

| 項目 | 内容 | 必須 |
|------|------|------|
| タイトル | バグの概要（50字以内） | ○ |
| 重要度 | Critical/High/Medium/Low | ○ |
| 発見日 | バグ発見日 | ○ |
| 発見者 | 報告者名 | ○ |
| 発見環境 | DEV/IT/ST/UAT | ○ |
| 再現手順 | 詳細な再現手順 | ○ |
| 期待結果 | あるべき動作 | ○ |
| 実際結果 | 実際の動作 | ○ |
| スクリーンショット | エラー画面等 | △ |
| ログ | 関連ログ | △ |
| 影響範囲 | 影響する機能・データ | ○ |
| 回避策 | 一時的な回避方法 | △ |

---

## 8. テストツール

### 8.1 使用ツール一覧

| 用途 | ツール | 備考 |
|------|--------|------|
| 単体テスト | JUnit 5 | Java単体テスト |
| 単体テスト（フロント） | Jest | React単体テスト |
| カバレッジ測定 | JaCoCo | コードカバレッジ |
| 静的解析 | SonarQube | コード品質 |
| APIテスト | Postman / Newman | API自動テスト |
| E2Eテスト | Playwright | ブラウザ自動テスト |
| 性能テスト | JMeter | 負荷テスト |
| セキュリティテスト | OWASP ZAP | 脆弱性診断 |
| バグ管理 | Jira | チケット管理 |
| テスト管理 | TestRail | テストケース管理 |
| CI/CD | GitHub Actions | 自動テスト実行 |

### 8.2 自動化範囲

| テストレベル | 自動化率目標 | 対象 |
|--------------|-------------|------|
| 単体テスト | 80%以上 | ビジネスロジック全般 |
| 結合テスト（API） | 70%以上 | REST API |
| 結合テスト（DB） | 60%以上 | DB連携 |
| システムテスト | 50%以上 | 主要シナリオ |
| 回帰テスト | 80%以上 | リリース前チェック |

---

## 9. 更新履歴

| 版数 | 更新日 | 更新者 | 更新内容 |
|------|--------|--------|----------|
| 1.0 | 2026/01/08 | システム設計チーム | 初版作成 |

---

## 【レビューチェックリスト】

- [ ] テスト範囲が全機能要件をカバーしているか
- [ ] 非機能要件（性能、セキュリティ等）のテストが計画されているか
- [ ] 会計システム固有のテスト観点（試算表一致、税集計等）が含まれているか
- [ ] 業種特化機能（不動産、有価証券）のテストが計画されているか
- [ ] インボイス制度対応のテストが計画されているか
- [ ] 電帳法要件のテストが計画されているか
- [ ] テストデータが正常系、異常系、境界値を網羅しているか
- [ ] 出口基準が定量的に定義されているか
- [ ] 性能テストの基準値が非機能要件と整合しているか
- [ ] 監査ログ検証が計画されているか
- [ ] 月次/年次決算シナリオが計画されているか
- [ ] バグ管理プロセスが定義されているか
- [ ] テスト環境が適切に計画されているか
- [ ] QAチームのレビューを受けているか
- [ ] ユーザー部門（経理部）のレビューを受けているか
